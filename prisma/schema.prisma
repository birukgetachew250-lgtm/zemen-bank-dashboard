// datasource "db" is the main user management database
datasource db {
  provider = "postgresql"
  url      = env("DASH_PROD_MODULE_DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native"]
}

// User model for admin panel users
model User {
  id         Int      @id @default(autoincrement())
  employeeId String   @unique
  name       String
  email      String   @unique
  password   String // In a real app, this should be a hash
  role       String
  department String
  branch     String?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

// Role model for defining user roles and permissions
model Role {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Branch model
model Branch {
  id          String       @id @default(uuid())
  name        String
  location    String
  departments Department[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

// Department model
model Department {
  id        String   @id @default(uuid())
  name      String
  branch    Branch   @relation(fields: [branchId], references: [id])
  branchId  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Mini App model
model MiniApp {
  id             String @id @default(uuid())
  name           String
  url            String
  logo_url       String
  username       String
  password       String
  encryption_key String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}
